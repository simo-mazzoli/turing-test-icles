<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <h2>Turing Test - Destinatario</h2>
    <div id="domanda"></div>
    <textarea id="risposta" placeholder="Scrivi la tua risposta"></textarea>
    <br><br>
    <button onclick="invia()">Invia</button>
    <button onclick="caricaDomanda()">Aggiorna prossima domanda</button>

    <script>
      let currentRow;

      function caricaDomanda() {
        google.script.run.withSuccessHandler(data => {
          document.getElementById("domanda").innerHTML = "<b>Domanda:</b> " + data.domanda;
          currentRow = data.riga;
          document.getElementById("risposta").value = ""; // reset risposta
        }).getUltimaDomanda();
      }

      function invia() {
        const risposta = document.getElementById("risposta").value;
        google.script.run.salvaRisposta(currentRow, risposta);
        alert("Risposta inviata!");
        caricaDomanda();
      }

      caricaDomanda();
    </script>
  </body>
</html>
